<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Emergency Contacts</title>
  <link rel="stylesheet" href="../css/style.css" />
</head>
<body>
  <div class="dashboard">
    <div class="sidebar">
      <h3>Navigation</h3>
      <ul></ul>
    </div>
    <div class="main-content">
      <h2>🚨 Emergency Contacts</h2>
      <p>Immediate help during critical situations.</p>

      <div class="emergency-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 30px;">
        
        <div class="emergency-card" style="background: #e74c3c; color: white; padding: 20px; border-radius: 10px; text-align: center;">
          <h3>🚑 Ambulance</h3>
          <p style="font-size: 24px; font-weight: bold;">102</p>
          <button class="btn" style="background: white; color: #e74c3c; margin-top: 10px;" onclick="callNumber('102')">Call Now</button>
        </div>

        <div class="emergency-card" style="background: #27ae60; color: white; padding: 20px; border-radius: 10px; text-align: center;">
          <h3>🔥 Fire Brigade</h3>
          <p style="font-size: 24px; font-weight: bold;">101</p>
          <button class="btn" style="background: white; color: #27ae60; margin-top: 10px;" onclick="callNumber('101')">Call Now</button>
        </div>

        <div class="emergency-card" style="background: #3498db; color: white; padding: 20px; border-radius: 10px; text-align: center;">
          <h3>👨‍⚕️ Doctor On Call</h3>
          <p style="font-size: 20px; font-weight: bold;">9876543212</p>
          <button class="btn" style="background: white; color: #3498db; margin-top: 10px;" onclick="callNumber('9876543212')">Call Now</button>
        </div>

        <div class="emergency-card" style="background: #9b59b6; color: white; padding: 20px; border-radius: 10px; text-align: center;">
          <h3>🏥 Nearby Hospital</h3>
          <p>City General Hospital</p>
          <p>0.5 km away</p>
          <button class="btn" style="background: white; color: #9b59b6; margin-top: 10px;" onclick="window.open('https://maps.google.com', '_blank')">View Map</button>
        </div>

        <div class="emergency-card" style="background: #f39c12; color: white; padding: 20px; border-radius: 10px; text-align: center;">
          <h3>👮 Hostel Head</h3>
          <p>Dr. Meena Reddy</p>
          <p>9876543211</p>
          <button class="btn" style="background: white; color: #f39c12; margin-top: 10px;" onclick="callNumber('9876543211')">Call Now</button>
        </div>

      </div>

      <div class="form" style="margin-top: 40px;">
        <h3>➕ Add Custom Emergency Contact</h3>
        <input type="text" id="contactName" placeholder="Name (e.g., Local Doctor)" />
        <input type="tel" id="contactNumber" placeholder="Phone Number" />
        <button onclick="addCustomContact()" class="btn btn-primary">Add Contact</button>
      </div>

      <div id="customContacts" style="margin-top: 30px;">
        <h3>📌 Your Saved Contacts</h3>
        <div id="customList"></div>
      </div>
    </div>
  </div>

  <script src="../js/script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      checkLogin();
      loadSidebar();
      loadCustomContacts();
    });

    function callNumber(num) {
      alert(`📞 Simulating call to ${num}\nIn real app, this would trigger tel:${num}`);
      // In real app: window.location.href = `tel:${num}`;
    }

    function addCustomContact() {
      const name = document.getElementById('contactName').value.trim();
      const number = document.getElementById('contactNumber').value.trim();

      if (!name || !number) {
        alert("Please enter both name and number");
        return;
      }

      const contacts = JSON.parse(localStorage.getItem('customContacts')) || [];
      contacts.push({ id: Date.now(), name, number });
      localStorage.setItem('customContacts', JSON.stringify(contacts));

      alert("Contact saved!");
      document.getElementById('contactName').value = '';
      document.getElementById('contactNumber').value = '';
      loadCustomContacts();
    }

    function loadCustomContacts() {
      const contacts = JSON.parse(localStorage.getItem('customContacts')) || [];
      const container = document.getElementById('customList');
      container.innerHTML = contacts.length === 0 ? 
        "<p>No custom contacts saved.</p>" :
        contacts.map(c => `
          <div style="background:white; padding:15px; margin:10px 0; border-radius:8px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
            <div>
              <strong>${c.name}</strong><br>
              ${c.number}
            </div>
            <button class="btn btn-danger" onclick="deleteContact(${c.id})">Delete</button>
          </div>
        `).join('');
    }

    function deleteContact(id) {
      let contacts = JSON.parse(localStorage.getItem('customContacts')) || [];
      contacts = contacts.filter(c => c.id !== id);
      localStorage.setItem('customContacts', JSON.stringify(contacts));
      loadCustomContacts();
    }
  </script>
</body>
</html>