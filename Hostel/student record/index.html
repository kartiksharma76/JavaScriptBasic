<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Engineering Student Grade Manager</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #0d1b2a, #1b263b, #415a77);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: start;
            padding: 20px;
            padding-top: 30px;
        }
        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            width: 100%;
            max-width: 1200px;
            overflow: hidden;
        }
        header {
            background: #0d1b2a;
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: #1b263b;
            padding: 10px;
            font-size: 14px;
        }
        .stat-item {
            text-align: center;
        }
        .stat-value {
            font-weight: bold;
            font-size: 18px;
            color: #4cc9f0;
        }
        .menu {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 12px;
        }
        .btn {
            background: #4361ee;
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .btn:hover {
            background: #3a0ca3;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .btn-danger { background: #e63946; }
        .btn-danger:hover { background: #d90429; }
        .btn-success { background: #2a9d8f; }
        .btn-success:hover { background: #1d7a6f; }
        .btn-warning { background: #e9c46a; color: #000; }
        .btn-warning:hover { background: #e76f51; color: white; }
        .form-section, .results-section {
            padding: 20px;
            display: none;
        }
        .active {
            display: block !important;
        }
        .form-group {
            margin-bottom: 18px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #0d1b2a;
        }
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        .marks-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        th, td {
            padding: 12px 10px;
            text-align: left;
            font-size: 14px;
            border: 1px solid #ddd;
        }
        th {
            background: #0d1b2a;
            color: white;
            position: sticky;
            top: 0;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        tr:hover {
            background: #e9ecef;
        }
        .back-btn {
            background: #6c757d;
            margin-top: 15px;
        }
        .back-btn:hover {
            background: #5a6268;
        }
        .message {
            padding: 12px;
            margin: 15px 0;
            border-radius: 8px;
            text-align: center;
            font-weight: 500;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .grade-A { color: #2a9d8f; font-weight: bold; }
        .grade-B { color: #4361ee; font-weight: bold; }
        .grade-C { color: #e9c46a; font-weight: bold; }
        .grade-D { color: #f4a261; font-weight: bold; }
        .grade-F { color: #e76f51; font-weight: bold; }
        .chart-container {
            height: 300px;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .action-btns {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }
        .action-btn {
            padding: 5px 10px;
            font-size: 12px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
        }
        .edit-btn { background: #4361ee; color: white; }
        .delete-btn { background: #e63946; color: white; }
        .export-btn {
            background: #7209b7;
            color: white;
            display: inline-flex;
            margin-top: 15px;
            padding: 10px 20px;
        }
        .export-btn:hover {
            background: #560bad;
        }
        .search-highlight {
            background: yellow;
            color: #000;
        }
        footer {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            color: #6c757d;
            font-size: 14px;
        }
        .student-details {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #4361ee;
        }
        .detail-row {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px 0;
            border-bottom: 1px solid #e9ecef;
        }
        .detail-label {
            font-weight: 600;
            color: #0d1b2a;
        }
        .detail-value {
            color: #495057;
        }
        @media (max-width: 768px) {
            .marks-container {
                grid-template-columns: 1fr;
            }
            .menu {
                grid-template-columns: repeat(2, 1fr);
            }
            th, td {
                padding: 8px 5px;
                font-size: 12px;
            }
            .detail-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéì Engineering Student Grade Manager</h1>
            <div class="stats-bar" id="statsBar">
                <div class="stat-item">
                    <div>Total Students</div>
                    <div class="stat-value" id="totalStudents">0</div>
                </div>
                <div class="stat-item">
                    <div>Average CGPA</div>
                    <div class="stat-value" id="classAverage">0.00</div>
                </div>
                <div class="stat-item">
                    <div>Top Engineer</div>
                    <div class="stat-value" id="topPerformer">-</div>
                </div>
            </div>
        </header>
        
        <div class="menu" id="menu">
            <button class="btn" onclick="showSection('add')">
                <span>‚ûï</span> Add Student
            </button>
            <button class="btn" onclick="showSection('view')">
                <span>üìä</span> View All
            </button>
            <button class="btn" onclick="showSection('search')">
                <span>üîç</span> Search
            </button>
            <button class="btn btn-success" onclick="showSection('analytics')">
                <span>üìà</span> Analytics
            </button>
            <button class="btn btn-warning" onclick="exportData()">
                <span>üì§</span> Export
            </button>
            <button class="btn btn-danger" onclick="resetData()">
                <span>üóëÔ∏è</span> Reset
            </button>
        </div>
        
        <!-- Add/Edit Student Form -->
        <div class="form-section" id="addSection">
            <h2 id="formTitle">Add Engineering Student</h2>
            <div id="formMessage"></div>
            <input type="hidden" id="editId">
            <div class="form-group">
                <label for="studentName">Full Name:</label>
                <input type="text" id="studentName" placeholder="Enter student's full name">
            </div>
            <div class="form-group">
                <label for="studentBranch">Engineering Branch:</label>
                <select id="studentBranch">
                    <option value="CSE">Computer Science & Engineering</option>
                    <option value="IT">Information Technology</option>
                    <option value="ECE">Electronics & Communication</option>
                    <option value="EEE">Electrical & Electronics</option>
                    <option value="ME">Mechanical Engineering</option>
                    <option value="CE">Civil Engineering</option>
                </select>
            </div>
            <div class="form-group">
                <label>Marks (0-100):</label>
                <div class="marks-container">
                    <div>
                        <label>Theory of Computation</label>
                        <input type="number" id="mark1" min="0" max="100" placeholder="TOC">
                    </div>
                    <div>
                        <label>Artificial Intelligence</label>
                        <input type="number" id="mark2" min="0" max="100" placeholder="AI">
                    </div>
                    <div>
                        <label>Computer Networks</label>
                        <input type="number" id="mark3" min="0" max="100" placeholder="CN">
                    </div>
                    <div>
                        <label>Operating Systems</label>
                        <input type="number" id="mark4" min="0" max="100" placeholder="OS">
                    </div>
                    <div>
                        <label>Coding & DSA</label>
                        <input type="number" id="mark5" min="0" max="100" placeholder="Coding">
                    </div>
                    <div>
                        <label>Technical Aptitude</label>
                        <input type="number" id="mark6" min="0" max="100" placeholder="Tech Test">
                    </div>
                    <div>
                        <label>Quantitative Aptitude</label>
                        <input type="number" id="mark7" min="0" max="100" placeholder="Aptitude">
                    </div>
                </div>
            </div>
            <button class="btn" id="submitBtn" onclick="submitStudent()">Add Student</button>
            <button class="btn back-btn" onclick="showSection('menu')">Back to Menu</button>
        </div>
        
        <!-- View All Students -->
        <div class="results-section" id="viewSection">
            <h2>üìö Engineering Student Records</h2>
            <div id="studentsTable"></div>
            <button class="btn back-btn" onclick="showSection('menu')">Back to Menu</button>
        </div>
        
        <!-- Search Student -->
        <div class="form-section" id="searchSection">
            <h2>üîç Search Engineering Records</h2>
            <div class="form-group">
                <label for="searchInput">Search by Name, ID, or Branch:</label>
                <input type="text" id="searchInput" placeholder="Enter search term..." oninput="liveSearch()">
            </div>
            <div id="searchResults"></div>
            <button class="btn back-btn" onclick="showSection('menu')">Back to Menu</button>
        </div>
        
        <!-- Analytics Dashboard -->
        <div class="results-section" id="analyticsSection">
            <h2>üìà Engineering Performance Analytics</h2>
            <div class="chart-container">
                <canvas id="gradeDistributionChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="subjectPerformanceChart"></canvas>
            </div>
            <div class="chart-container">
                <canvas id="branchComparisonChart"></canvas>
            </div>
            <button class="btn back-btn" onclick="showSection('menu')">Back to Menu</button>
        </div>
        
        <footer>
            <p>Engineering Student Grade Manager ‚Ä¢ IIT/JEE Preparation Focused</p>
        </footer>
    </div>

    <script>
        // Engineering student data storage
        let students = JSON.parse(localStorage.getItem('students')) || [];
        let nextId = students.length > 0 ? Math.max(...students.map(s => s.id)) + 1 : 1;
        let charts = {};

        // Register Chart.js components
        Chart.register(
            Chart.DoughnutController,
            Chart.BarController,
            Chart.RadarController,
            Chart.ArcElement,
            Chart.BarElement,
            Chart.LineElement,
            Chart.PointElement,
            Chart.CategoryScale,
            Chart.LinearScale,
            Chart.RadialLinearScale,
            Chart.Title,
            Chart.Tooltip,
            Chart.Legend
        );

        // Subject names for engineering
        const SUBJECTS = [
            'Theory of Computation',
            'Artificial Intelligence',
            'Computer Networks',
            'Operating Systems',
            'Coding & DSA',
            'Technical Aptitude',
            'Quantitative Aptitude'
        ];

        // Subject abbreviations for display
        const SUBJECT_ABBR = ['TOC', 'AI', 'CN', 'OS', 'Coding', 'Tech Apt', 'Quant Apt'];

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            updateStats();
            showSection('menu');
        });

        // Show specific section
        function showSection(sectionId) {
            document.querySelectorAll('.form-section, .results-section, .menu').forEach(el => {
                el.classList.remove('active');
            });
            
            if (sectionId === 'menu') {
                document.getElementById('menu').classList.add('active');
            } else {
                document.getElementById(sectionId + 'Section').classList.add('active');
                
                if (sectionId === 'view') {
                    renderStudentsTable();
                } else if (sectionId === 'analytics') {
                    renderAnalytics();
                }
            }
        }

        // Submit student (add or edit)
        function submitStudent() {
            const id = document.getElementById('editId').value;
            const name = document.getElementById('studentName').value.trim();
            const branch = document.getElementById('studentBranch').value;
            
            const marks = [];
            for (let i = 1; i <= 7; i++) {
                const mark = parseFloat(document.getElementById(`mark${i}`).value);
                marks.push(mark);
            }
            
            const messageEl = document.getElementById('formMessage');
            
            if (!name) {
                showMessage(messageEl, 'Please enter student name', 'error');
                return;
            }
            
            for (let i = 0; i < marks.length; i++) {
                if (isNaN(marks[i]) || marks[i] < 0 || marks[i] > 100) {
                    showMessage(messageEl, `Invalid marks for ${SUBJECTS[i]}! Must be between 0-100.`, 'error');
                    return;
                }
            }
            
            const total = marks.reduce((sum, mark) => sum + mark, 0);
            const average = total / marks.length;
            let grade;
            if (average >= 90) grade = 'A';
            else if (average >= 80) grade = 'B';
            else if (average >= 70) grade = 'C';
            else if (average >= 60) grade = 'D';
            else grade = 'F';
            
            const cgpa = (average / 10).toFixed(2);
            
            const student = {
                id: id ? parseInt(id) : nextId++,
                name: name,
                branch: branch,
                marks: marks,
                total: total,
                average: average,
                grade: grade,
                cgpa: parseFloat(cgpa),
                timestamp: id ? Date.now() : Date.now()
            };
            
            if (id) {
                const index = students.findIndex(s => s.id === parseInt(id));
                if (index !== -1) {
                    students[index] = student;
                    showMessage(messageEl, 'Student updated successfully!', 'success');
                }
            } else {
                students.push(student);
                showMessage(messageEl, `Student added successfully! ID: ${student.id}`, 'success');
            }
            
            saveData();
            updateStats();
            clearForm();
        }

        // Clear form
        function clearForm() {
            document.getElementById('editId').value = '';
            document.getElementById('studentName').value = '';
            document.getElementById('studentBranch').value = 'CSE';
            for (let i = 1; i <= 7; i++) {
                document.getElementById(`mark${i}`).value = '';
            }
            document.getElementById('formTitle').textContent = 'Add Engineering Student';
            document.getElementById('submitBtn').textContent = 'Add Student';
        }

        // Edit student
        function editStudent(id) {
            const student = students.find(s => s.id === id);
            if (!student) return;
            
            document.getElementById('editId').value = student.id;
            document.getElementById('studentName').value = student.name;
            document.getElementById('studentBranch').value = student.branch;
            for (let i = 0; i < 7; i++) {
                document.getElementById(`mark${i+1}`).value = student.marks[i];
            }
            document.getElementById('formTitle').textContent = 'Edit Student';
            document.getElementById('submitBtn').textContent = 'Update Student';
            showSection('add');
        }

        // Delete student
        function deleteStudent(id) {
            if (confirm('Are you sure you want to delete this engineering student record?')) {
                students = students.filter(s => s.id !== id);
                saveData();
                updateStats();
                renderStudentsTable();
                showMessage(document.getElementById('studentsTable'), 'Student deleted successfully!', 'success');
            }
        }

        // Render students table with row-wise data
        function renderStudentsTable() {
            if (students.length === 0) {
                document.getElementById('studentsTable').innerHTML = '<div class="message warning">No engineering students found! Add some students to get started.</div>';
                return;
            }
            
            const sortedStudents = [...students].sort((a, b) => b.cgpa - a.cgpa);
            let tableHTML = '';
            
            sortedStudents.forEach(student => {
                tableHTML += `
                    <div class="student-details">
                        <div class="detail-row">
                            <span class="detail-label">Student ID:</span>
                            <span class="detail-value">${student.id}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Name:</span>
                            <span class="detail-value">${student.name}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Branch:</span>
                            <span class="detail-value">${student.branch}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Subject Marks:</span>
                            <span class="detail-value"></span>
                        </div>
                `;
                
                // Add subject marks in rows
                student.marks.forEach((mark, index) => {
                    tableHTML += `
                        <div class="detail-row" style="padding-left: 20px;">
                            <span class="detail-label">${SUBJECT_ABBR[index]}:</span>
                            <span class="detail-value">${mark}</span>
                        </div>
                    `;
                });
                
                tableHTML += `
                        <div class="detail-row">
                            <span class="detail-label">Total Marks:</span>
                            <span class="detail-value">${student.total}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Average:</span>
                            <span class="detail-value">${student.average.toFixed(2)}%</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">CGPA:</span>
                            <span class="detail-value">${student.cgpa}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Grade:</span>
                            <span class="detail-value grade-${student.grade}">${student.grade}</span>
                        </div>
                        <div class="action-btns">
                            <button class="action-btn edit-btn" onclick="editStudent(${student.id})">Edit</button>
                            <button class="action-btn delete-btn" onclick="deleteStudent(${student.id})">Delete</button>
                        </div>
                    </div>
                `;
            });
            
            tableHTML += `<button class="export-btn" onclick="exportToCSV()">üì• Export to CSV</button>`;
            document.getElementById('studentsTable').innerHTML = tableHTML;
        }

        // Live search with row-wise display
        function liveSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const resultsEl = document.getElementById('searchResults');
            
            if (!searchTerm) {
                resultsEl.innerHTML = '<div class="message">Enter a name, ID, or branch to search...</div>';
                return;
            }
            
            const filtered = students.filter(student => 
                student.name.toLowerCase().includes(searchTerm) ||
                student.id.toString().includes(searchTerm) ||
                student.branch.toLowerCase().includes(searchTerm)
            );
            
            if (filtered.length === 0) {
                resultsEl.innerHTML = '<div class="message warning">No engineering students found matching your search.</div>';
                return;
            }
            
            let resultsHTML = `<div class="message success">Found ${filtered.length} result(s):</div>`;
            
            filtered.forEach(student => {
                const highlightedName = highlightText(student.name, searchTerm);
                
                resultsHTML += `
                    <div class="student-details">
                        <div class="detail-row">
                            <span class="detail-label">Student ID:</span>
                            <span class="detail-value">${student.id}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Name:</span>
                            <span class="detail-value">${highlightedName}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Branch:</span>
                            <span class="detail-value">${student.branch}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">CGPA:</span>
                            <span class="detail-value">${student.cgpa}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Grade:</span>
                            <span class="detail-value grade-${student.grade}">${student.grade}</span>
                        </div>
                    </div>
                `;
            });
            
            resultsEl.innerHTML = resultsHTML;
        }

        // Highlight search terms
        function highlightText(text, searchTerm) {
            if (!searchTerm) return text;
            const regex = new RegExp(`(${searchTerm})`, 'gi');
            return text.replace(regex, '<span class="search-highlight">$1</span>');
        }

        // Render analytics dashboard
        function renderAnalytics() {
            if (students.length === 0) {
                document.getElementById('analyticsSection').innerHTML = 
                    '<div class="message warning">No data available for analytics. Add some engineering students first!</div>' + 
                    '<button class="btn back-btn" onclick="showSection(\'menu\')">Back to Menu</button>';
                return;
            }
            
            // Destroy existing charts
            Object.values(charts).forEach(chart => {
                if (chart) chart.destroy();
            });
            
            // Grade Distribution Chart
            const gradeCtx = document.getElementById('gradeDistributionChart').getContext('2d');
            const gradeData = calculateGradeDistribution();
            charts.grade = new Chart(gradeCtx, {
                type: 'doughnut',
                data: {
                    labels: ['A', 'B', 'C', 'D', 'F'],
                    datasets: [{
                        data: [gradeData.A, gradeData.B, gradeData.C, gradeData.D, gradeData.F],
                        backgroundColor: ['#2a9d8f', '#4361ee', '#e9c46a', '#f4a261', '#e76f51'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Grade Distribution (Engineering Students)',
                            font: { size: 16 }
                        },
                        legend: { position: 'bottom' }
                    }
                }
            });
            
            // Subject Performance Chart
            const subjectCtx = document.getElementById('subjectPerformanceChart').getContext('2d');
            const subjectData = calculateSubjectAverages();
            charts.subject = new Chart(subjectCtx, {
                type: 'bar',
                data: {
                    labels: SUBJECTS.map(s => s.split(' ')[0]),
                    datasets: [{
                        label: 'Average Score',
                        data: subjectData,
                        backgroundColor: ['#4361ee', '#3a86ff', '#ff006e', '#8338ec', '#4cc9f0', '#f72585', '#b5179e'],
                        borderRadius: 5,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Subject-wise Performance (Core Engineering)',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
            
            // Branch Comparison Chart
            const branchCtx = document.getElementById('branchComparisonChart').getContext('2d');
            const branchData = calculateBranchAverages();
            charts.branch = new Chart(branchCtx, {
                type: 'radar',
                data: {
                    labels: Object.keys(branchData),
                    datasets: [{
                        label: 'Branch Average CGPA',
                        data: Object.values(branchData),
                        borderColor: '#ff006e',
                        backgroundColor: 'rgba(255, 0, 110, 0.1)',
                        borderWidth: 3,
                        pointBackgroundColor: '#4361ee',
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Branch Performance Comparison',
                            font: { size: 16 }
                        }
                    },
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 10
                        }
                    }
                }
            });
        }

        // Calculate grade distribution
        function calculateGradeDistribution() {
            const grades = { A: 0, B: 0, C: 0, D: 0, F: 0 };
            students.forEach(student => {
                grades[student.grade]++;
            });
            return grades;
        }

        // Calculate subject averages
        function calculateSubjectAverages() {
            if (students.length === 0) return Array(7).fill(0);
            
            const subjectTotals = Array(7).fill(0);
            
            students.forEach(student => {
                for (let i = 0; i < 7; i++) {
                    subjectTotals[i] += student.marks[i];
                }
            });
            
            return subjectTotals.map(total => parseFloat((total / students.length).toFixed(2)));
        }

        // Calculate branch averages
        function calculateBranchAverages() {
            const branchAverages = {};
            const branchCounts = {};
            
            students.forEach(student => {
                if (!branchAverages[student.branch]) {
                    branchAverages[student.branch] = 0;
                    branchCounts[student.branch] = 0;
                }
                branchAverages[student.branch] += student.cgpa;
                branchCounts[student.branch]++;
            });
            
            Object.keys(branchAverages).forEach(branch => {
                branchAverages[branch] = parseFloat((branchAverages[branch] / branchCounts[branch]).toFixed(2));
            });
            
            return branchAverages;
        }

        // Update statistics bar
        function updateStats() {
            document.getElementById('totalStudents').textContent = students.length;
            
            if (students.length > 0) {
                const classAvg = students.reduce((sum, s) => sum + s.cgpa, 0) / students.length;
                document.getElementById('classAverage').textContent = classAvg.toFixed(2);
                
                const topStudent = students.reduce((prev, current) => 
                    (prev.cgpa > current.cgpa) ? prev : current
                );
                document.getElementById('topPerformer').textContent = topStudent.name;
            } else {
                document.getElementById('classAverage').textContent = '0.00';
                document.getElementById('topPerformer').textContent = '-';
            }
            
            saveData();
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('students', JSON.stringify(students));
        }

        // Export data to CSV
        function exportToCSV() {
            if (students.length === 0) {
                alert('No data to export!');
                return;
            }
            
            let csv = 'ID,Name,Branch,TOC,AI,CN,OS,Coding,TechAptitude,QuantAptitude,CGPA,Grade\n';
            students.forEach(s => {
                csv += `${s.id},"${s.name}",${s.branch},${s.marks[0]},${s.marks[1]},${s.marks[2]},${s.marks[3]},${s.marks[4]},${s.marks[5]},${s.marks[6]},${s.cgpa},${s.grade}\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', 'engineering_grades.csv');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // Export all data (JSON)
        function exportData() {
            if (students.length === 0) {
                alert('No data to export!');
                return;
            }
            
            const dataStr = JSON.stringify(students, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const exportFileDefaultName = 'engineering_student_data.json';
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
        }

        // Reset all data
        function resetData() {
            if (confirm('‚ö†Ô∏è This will delete ALL engineering student records permanently. Are you sure?')) {
                students = [];
                nextId = 1;
                localStorage.removeItem('students');
                updateStats();
                showSection('menu');
                alert('All engineering data has been reset!');
            }
        }

        // Show message helper
        function showMessage(element, text, type) {
            element.innerHTML = `<div class="message ${type}">${text}</div>`;
            setTimeout(() => {
                if (element.querySelector('.message')) {
                    element.innerHTML = '';
                }
            }, 4000);
        }
    </script>
</body>
</html>